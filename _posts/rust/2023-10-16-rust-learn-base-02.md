---
layout: post
title: Rust 基础入门 - 02
categories: [Rust]
description: Rust 基础入门 - 02
keywords: Rust 基础入门 - 02
---

这是 bran 学习 Rust 的笔记 & 心得系列，目前是 Rust 基础入门 - 02（所有权和借用、复合类型），刚开始学哦～ 加油！！！

## 所有权

因为程序要运行，就要和计算机内存打交道，那么如何在内存中申请空间、释放空间，成了语言设计的重中之重。

应用程序和计算机内存的爱恨情仇，目前有三种流派。

1. **垃圾回收机制（Garbage Collection）**，在程序运行时，不断寻找不再使用的内存，进行回收处理。典型代表：Java、Go、JavaScript
2. **手动管理内存的分配和释放**，在程序中，通过函数调用的方式来申请和释放内存。典型代表：C、C++、早期的 OC
3. **通过所有权来管理内存**，编译器在编译时会根据一系列的规则进行检查

Rust 选择了第三种，这种检查只发生在编译期，因此对于程序运行期，不会有任何性能上的损失。（还不太懂这个为什么没有，带着疑惑继续学习）

## 栈(Stack)和堆(Heap)

在 Rust 中，栈和堆是最核心的数据结构，数据是位于栈上，还是堆上，非常重要，因为这会影响程序的行为和性能

> Me：对于 jser 来说，这个概念应该好理解的

### 栈

- 按照顺序存储值并以相反的顺序取出值，（先进后出）（后进先出）。
- 增加数据叫***进栈***，移出数据叫***出栈***
- 栈中的所有数据都必须占有**已知且固定大小的内存空间**，假设数据大小是未知的，那么取出数据时，将无法取到想要的数据。。

### 堆

- 与栈不同，大小未知或者可能变化的数据，可以存放在堆上
- 堆的内存空间不连续
- 向堆上存放数据时，先申请一定大小的空间，操作系统在堆的某处找到足够大的空间后，将其标记为已使用，并返回一个表示该地址的**指针**。该过程被称为**在堆上分配内存**，有时简称“分配”（allocating）
- 该指针会被推入栈中，后续通过该指针来访问实际的内存位置，进而访问数据

### 性能区别

- 写入方面：入栈比在堆上分配内存更快
- 读取方面：由于堆的内存地址也是在栈中，再加上现代的 CPU 性能及高速缓存，栈的访问速度也是优于堆的

因此，处理器处理分配在栈上数据会比在堆上的数据更加高效。

### 所有权与堆栈

对于其他很多编程语言，你确实无需理解堆栈的原理，但是**在 Rust 中，明白堆栈的原理，对于我们理解所有权的工作原理会有很大的帮助**。
